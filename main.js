!function(){"use strict";const t=document.querySelector(".form"),e=document.querySelector(".profile__info-button"),s=document.querySelector(".profile__button"),n=document.querySelector("#form_post"),i={formSelector:".form",inputSelector:".form__info-input",submitButtonSelector:".form__info-button",inactiveButtonClass:"form__info-button_disabled",inputErrorClass:"form__info-input_type_error",errorClass:"form__info_error_visible"};var o=class{constructor(t,e){this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inactiveErrosClass,this._errorClass=t.errorClass,this._form=e,this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(t){const e=this._form.querySelector("#".concat(t.id,"-error"));e.textContent=t.validationMessage,e.classList.add(this._errorClass),t.classList.add(this._inputErrorClass)}_hideInputError(t){const e=this._form.querySelector("#".concat(t.id,"-error"));e.textContent="",e.classList.remove(this._errorClass),t.classList.remove(this._errorClass)}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t)}_checkIfAllInputsValid(){return this._inputList.every((t=>t.validity.valid))}toggleButton(){this._checkIfAllInputsValid()?(this._submitButton.disabled=!1,this._submitButton.classList.remove(this._inactiveButtonClass)):(this._submitButton.disabled=!0,this._submitButton.classList.add(this._inactiveButtonClass))}_setEventListeners(){this.toggleButton(),this._inputList.forEach((t=>{t.addEventListener("input",(e=>{e.preventDefault(),this._checkInputValidity(t),this.toggleButton()}))}))}enableValidation(){this._form.addEventListener("submit",(t=>t.preventDefault())),this._setEventListeners()}};class r{constructor(t){this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_enabled"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_enabled"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",(t=>{t.target.classList.contains("popup")&&this.close()})),this._popup.querySelector(".popup__content-close").addEventListener("click",(()=>this.close()))}}class a extends r{constructor(t,e){let{handleFormSubmit:s}=e;super(t),this._form=this._popup.querySelector(".form"),this._handleFormSubmit=s,this._inputList=this._form.querySelectorAll(".form__info-input")}_getInputValues(){return this._data={},this._inputList.forEach((t=>{this._data[t.name]=t.value})),this._data}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}setInputValues(t){this._inputList.forEach((e=>{e.value=t[e.name]}))}close(){super.close(),this._form.reset()}}const l=new class{constructor(t){let{nameSelector:e,jobSelector:s}=t;this._name=document.querySelector(e),this._job=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,occupation:this._job.textContent}}setUserInfo(t){this._name.textContent=t.name,this._job.textContent=t.occupation}}({nameSelector:".profile__info-title",jobSelector:".profile__info-subtitle"}),c=new a("#edit_popup",{handleFormSubmit:t=>{l.setUserInfo(t)}}),u=new a("#popup_post",{handleFormSubmit:t=>{const e=d(t);p.addItem(e)}}),_=new class extends r{constructor(t){super(t),this._caption=this._popup.querySelector(".popup__title"),this._popupImage=this._popup.querySelector(".popup__image")}open(t,e){super.open(),this._caption.textContent=t,this._popupImage.src=e,this._popupImage.alt="A photo of ".concat(t)}}(".popup_type_preview");_.setEventListeners(),s.addEventListener("click",(()=>{u.open(),f.toggleButton()})),u.setEventListeners(),e.addEventListener("click",(()=>{c.open(),c.setInputValues(l.getUserInfo()),m.toggleButton()})),c.setEventListeners();const d=t=>new class{constructor(t,e,s){this.handleCardClick=s,this._name=t.name,this._link=t.link,this._cardSelector=e}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_handleLikeIcon(t){t.target.classList.toggle("card__info-button_active")}_handleDeleteIcon(){this._template.remove(),this._template=null}_setEventListeners(){this._likeButton.addEventListener("click",this._handleLikeIcon),this._deleteButton.addEventListener("click",this._handleDeleteIcon.bind(this)),this._cardImage.addEventListener("click",this.handleCardClick)}generateCard(){return this._template=this._getTemplate(),this._likeButton=this._template.querySelector(".card__info-button"),this._deleteButton=this._template.querySelector(".card__trash"),this._cardImage=this._template.querySelector(".card__image"),this._template.querySelector(".card__info-title").textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt="A picture of ".concat(this._name),this._setEventListeners(),this._template}}(t,"#card-template",(()=>{h(t)})).generateCard(),h=t=>{_.open(t.name,t.link)},p=new class{constructor(t,e){let{items:s,renderer:n}=t;this._renderedItems=s,this._renderer=n,this._container=document.querySelector(e)}addItem(t){this._container.prepend(t)}renderItems(){this._renderedItems.forEach((t=>{this._renderer(t)}))}}({items:[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}],renderer:t=>{const e=d(t);p.addItem(e)}},".elements");p.renderItems();const m=new o(i,t),f=new o(i,n);m.enableValidation(),f.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUVSLENBQ0V0QixLQUFNLFVBQ05zQixLQUFNLG1EQUVSLENBQ0V0QixLQUFNLHdCQUNOc0IsS0FBTSxtREFFUixDQUNFdEIsS0FBTSxpQkFDTnNCLEtBQU0saURJa0JWdUIsU0FBV0gsSUFDVCxNQUFNM0IsRUFBY0MsRUFBVzBCLEdBQy9CekIsRUFBV0MsUUFBUUgsS0pqREUsYUl1RHpCRSxFQUFXa0MsY0FLWCxNQUFNekIsRUFBb0IsSUFBSTBCLEVBQWNwSCxFQUFvQk4sR0FDMUQrRixFQUFvQixJQUFJMkIsRUFBY3BILEVBQW9CRCxHQUVoRTJGLEVBQWtCN0MsbUJBQ2xCNEMsRUFBa0I1QyxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy9mb3JtIGVsZW1lbnRzXHJcbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuXHJcbi8vcHJvZmlsZSBlbGVtZW50c1xyXG5jb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbmZvLWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBcIi5wcm9maWxlX19pbmZvLXRpdGxlXCI7XHJcbmNvbnN0IHByb2ZpbGVKb2IgPSBcIi5wcm9maWxlX19pbmZvLXN1YnRpdGxlXCI7XHJcblxyXG4vL3BvcHVwIGVsZW1lbnRzXHJcbmNvbnN0IGVkaXRQb3B1cCA9IFwiI2VkaXRfcG9wdXBcIjtcclxuY29uc3QgcG9zdFBvcHVwID0gXCIjcG9wdXBfcG9zdFwiO1xyXG5cclxuLy9wb3N0IGVsZW1lbnRzXHJcbmNvbnN0IHBvc3RCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2J1dHRvblwiKTtcclxuY29uc3QgY2FyZExpc3RTZWxlY3RvciA9IFwiLmVsZW1lbnRzXCI7XHJcbmNvbnN0IHBvc3RGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZm9ybV9wb3N0XCIpO1xyXG5cclxuLy9wcmV2aWV3IHBvc3QgZWxlbWVudHNcclxuY29uc3QgcHJldmlldyA9IFwiLnBvcHVwX3R5cGVfcHJldmlld1wiO1xyXG5cclxuY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCJcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIlxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIlxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIlxyXG4gICAgfVxyXG4gIF07XHJcblxyXG5jb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5mby1pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19pbmZvLWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9faW5mby1idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5mby1pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJmb3JtX19pbmZvX2Vycm9yX3Zpc2libGVcIlxyXG59O1xyXG5cclxuXHJcbiAgZXhwb3J0IHsgXHJcbiAgICBlZGl0Rm9ybUVsZW1lbnQsIGVkaXRCdXR0b24sIHByb2ZpbGVOYW1lLFxyXG4gICAgcHJvZmlsZUpvYiwgZWRpdFBvcHVwLCBwb3N0UG9wdXAsIHBvc3RCdXR0b24sIFxyXG4gICAgY2FyZExpc3RTZWxlY3RvciwgcG9zdEZvcm1FbGVtZW50LCBwcmV2aWV3LCBpbml0aWFsQ2FyZHMsIHZhbGlkYXRpb25TZXR0aW5nc1xyXG59OyIsImNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gICAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVFcnJvc0NsYXNzO1xyXG4gICAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuICAgICAgXHJcbiAgICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcclxuICAgICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcikpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgfTtcclxuICBcclxuICAgIF9zaG93SW5wdXRFcnJvcihpbnB1dCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXQuaWR9LWVycm9yYCk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KSB7XHJcbiAgICAgICAgaWYgKGlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja0lmQWxsSW5wdXRzVmFsaWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5ldmVyeShpbnB1dCA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcbiAgICB9XHJcbiAgICBcclxuXHJcbiAgICB0b2dnbGVCdXR0b24oKSB7XHJcbiAgICAgICAgLy8gY2hlY2sgaWYgYWxsIGlucHV0cyBhcmUgdmFsaWRcclxuICAgICAgICBpZih0aGlzLl9jaGVja0lmQWxsSW5wdXRzVmFsaWQoKSl7XHJcbiAgICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gc2V0IGJ1dHRvbiB0byBkaXNhYmxlZCB3aGVuIGZpcnN0IGxvYWRpbmcgZm9ybVxyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uKCk7XHJcbiAgICAvLyBzZXQgZXZlbnQgbGlzdGVuZXJzIGZvciBlYWNoIGlucHV0XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAvLyBjaGVjayB2YWxpZGl0eVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KTtcclxuICAgICAgICAgICAgICAgIC8vIHRvZ2dsZSBidXR0b25cclxuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uKCk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfTtcclxuXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uICgpIHtcclxuICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBldnQgPT4gZXZ0LnByZXZlbnREZWZhdWx0KCkpO1xyXG4gICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgfTtcclxufTtcclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4oKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX2VuYWJsZWRcIik7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9lbmFibGVkXCIpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICAgICAvLyBldnQucHJldmVudERlZmF1bHQoKTsgLy8gZG9lcyBub3Qgd29yayBvdXRzaWRlIGlmIHN0YXRlbWVudFxyXG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgIC8vZXZ0LnByZXZlbnREZWZhdWx0KCk7IHdvdWxkIHdvcmtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikpe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY29udGVudC1jbG9zZVwiKVxyXG4gICAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4gdGhpcy5jbG9zZSgpKTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCB7aGFuZGxlRm9ybVN1Ym1pdH0pIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLmZvcm0nKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb3JtX19pbmZvLWlucHV0Jyk7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIHRoaXMuX2RhdGEgPSB7fTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2RhdGFbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHNldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgeyBcclxuICBlZGl0Rm9ybUVsZW1lbnQsIGVkaXRCdXR0b24sIHByb2ZpbGVOYW1lLFxyXG4gIHByb2ZpbGVKb2IsIGVkaXRQb3B1cCwgcG9zdFBvcHVwLCBwb3N0QnV0dG9uLCBcclxuICBjYXJkTGlzdFNlbGVjdG9yLCBwb3N0Rm9ybUVsZW1lbnQsIHByZXZpZXcsIGluaXRpYWxDYXJkcywgdmFsaWRhdGlvblNldHRpbmdzIFxyXG59IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcyc7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5cclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuXHJcblxyXG4vLyBQT1BVUCBGVU5DVElPTlMgLyBPQkpFQ1RTIC8vXHJcbmNvbnN0IG5ld1VzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtuYW1lU2VsZWN0b3I6IHByb2ZpbGVOYW1lLCBqb2JTZWxlY3RvcjogcHJvZmlsZUpvYn0pO1xyXG5cclxuY29uc3QgZWRpdEZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKGVkaXRQb3B1cCwge2hhbmRsZUZvcm1TdWJtaXQ6IChkYXRhKSA9PiB7XHJcbiAgbmV3VXNlckluZm8uc2V0VXNlckluZm8oZGF0YSk7XHJcbn19KVxyXG5cclxuXHJcbmNvbnN0IHBvc3RGb3JtUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShwb3N0UG9wdXAsIHtoYW5kbGVGb3JtU3VibWl0OiAoZGF0YSkgPT4ge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChkYXRhKTtcclxuICBwbGFjZUNhcmRzLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG59fSk7XHJcblxyXG5jb25zdCBwcmV2aWV3SW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShwcmV2aWV3KTtcclxucHJldmlld0ltYWdlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIFNFVCBFVkVOVCBIQU5ETEVSUyAvL1xyXG5cclxucG9zdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT4ge1xyXG4gIHBvc3RGb3JtUG9wdXAub3BlbigpO1xyXG4gIHBvc3RGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvbigpO1xyXG59KTtcclxuXHJcbnBvc3RGb3JtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgZWRpdEZvcm1Qb3B1cC5vcGVuKCkgO1xyXG4gIGVkaXRGb3JtUG9wdXAuc2V0SW5wdXRWYWx1ZXMobmV3VXNlckluZm8uZ2V0VXNlckluZm8oKSk7XHJcbiAgZWRpdEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uKCk7XHJcbn0pO1xyXG5cclxuZWRpdEZvcm1Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8gQ0FSRCBGVU5DVElPTlMgLy9cclxuXHJcbmNvbnN0IGNyZWF0ZUNhcmQgPSAoZGF0YSkgPT4ge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChkYXRhLCBcIiNjYXJkLXRlbXBsYXRlXCIsICgpPT4ge2hhbmRsZUNhcmRDbGljayhkYXRhKX0pO1xyXG4gIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG59XHJcblxyXG5jb25zdCBoYW5kbGVDYXJkQ2xpY2sgPSAoaXRlbSkgPT4ge1xyXG4gIHByZXZpZXdJbWFnZVBvcHVwLm9wZW4oaXRlbS5uYW1lLCBpdGVtLmxpbmspO1xyXG59XHJcblxyXG5jb25zdCBwbGFjZUNhcmRzID0gbmV3IFNlY3Rpb24oe1xyXG4gIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSk7XHJcbiAgICBwbGFjZUNhcmRzLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4gIH19LCBjYXJkTGlzdFNlbGVjdG9yXHJcbik7XHJcblxyXG5cclxuLy8gUkVOREVSIENBUkRTIC8vXHJcbnBsYWNlQ2FyZHMucmVuZGVySXRlbXMoKTtcclxuXHJcblxyXG4vLyBWQUxJREFUSU9OIC8vXHJcblxyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZWRpdEZvcm1FbGVtZW50KTtcclxuY29uc3QgcG9zdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIHBvc3RGb3JtRWxlbWVudCk7XHJcblxyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbnBvc3RGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTsiLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7bmFtZVNlbGVjdG9yLCBqb2JTZWxlY3Rvcn0pIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2pvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiB7bmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCwgb2NjdXBhdGlvbjogdGhpcy5fam9iLnRleHRDb250ZW50fTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyhkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgICAgICB0aGlzLl9qb2IudGV4dENvbnRlbnQgPSBkYXRhLm9jY3VwYXRpb247XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9jYXB0aW9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX190aXRsZScpO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgICAgIHRoaXMuX2NhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gbGluaztcclxuICAgICAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGBBIHBob3RvIG9mICR7bmFtZX1gO1xyXG4gICAgfVxyXG59IiwiY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihkYXRhLCBjYXJkU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaykge1xyXG4gICAgICAgIHRoaXMuaGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICAgICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuXHJcbiAgICAgICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlTGlrZUljb24oZXZ0KSB7XHJcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9faW5mby1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVEZWxldGVJY29uKCkge1xyXG4gICAgICAgIHRoaXMuX3RlbXBsYXRlLnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX3RlbXBsYXRlID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTGlrZUljb24pO1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlRGVsZXRlSWNvbi5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuaGFuZGxlQ2FyZENsaWNrKTtcclxuICAgIH1cclxuXHJcbiAgICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fdGVtcGxhdGUgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl90ZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2luZm8tYnV0dG9uXCIpO1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX3RlbXBsYXRlLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2hcIik7XHJcbiAgICAgICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fdGVtcGxhdGUucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5fdGVtcGxhdGUucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbmZvLXRpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgICAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gYEEgcGljdHVyZSBvZiAke3RoaXMuX25hbWV9YDtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5fdGVtcGxhdGU7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBDYXJkOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3Ioe2l0ZW1zLCByZW5kZXJlcn0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcblxyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG59Il0sIm5hbWVzIjpbImVkaXRGb3JtRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImVkaXRCdXR0b24iLCJwb3N0QnV0dG9uIiwicG9zdEZvcm1FbGVtZW50IiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJjb25zdHJ1Y3RvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbmFjdGl2ZUVycm9zQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9mb3JtIiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXQiLCJlcnJvckVsZW1lbnQiLCJpZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJjbGFzc0xpc3QiLCJhZGQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0lmQWxsSW5wdXRzVmFsaWQiLCJldmVyeSIsInRvZ2dsZUJ1dHRvbiIsImRpc2FibGVkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsImVuYWJsZVZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfZGF0YSIsIm5hbWUiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwiZGF0YSIsInJlc2V0IiwibmV3VXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9uYW1lIiwiX2pvYiIsImdldFVzZXJJbmZvIiwib2NjdXBhdGlvbiIsInNldFVzZXJJbmZvIiwiZWRpdEZvcm1Qb3B1cCIsInBvc3RGb3JtUG9wdXAiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJwbGFjZUNhcmRzIiwiYWRkSXRlbSIsInByZXZpZXdJbWFnZVBvcHVwIiwiX2NhcHRpb24iLCJfcG9wdXBJbWFnZSIsImxpbmsiLCJzcmMiLCJhbHQiLCJwb3N0Rm9ybVZhbGlkYXRvciIsImVkaXRGb3JtVmFsaWRhdG9yIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9oYW5kbGVMaWtlSWNvbiIsInRvZ2dsZSIsIl9oYW5kbGVEZWxldGVJY29uIiwiX3RlbXBsYXRlIiwiX2xpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZSIsImdlbmVyYXRlQ2FyZCIsIml0ZW0iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfcmVuZGVyZWRJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJlbGVtZW50IiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwiRm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=